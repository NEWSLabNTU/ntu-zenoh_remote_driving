# direnv configuration for Zenoh Remote Driving
# Run `direnv allow` to enable

AUTOSDV_LINK="${PWD}/script/AutoSDV"

# Check if AutoSDV symlink exists and is valid
if [[ ! -L "${AUTOSDV_LINK}" ]] || [[ ! -d "${AUTOSDV_LINK}" ]]; then
    echo "ERROR: script/AutoSDV symlink is missing or invalid."
    echo "Please create it with:"
    echo "  ln -sfn /path/to/AutoSDV script/AutoSDV"
    return 1
fi

# Source AutoSDV (chains to /opt/ros/humble/setup.bash)
source "${AUTOSDV_LINK}/install/setup.bash"

# Watch and source project workspace if it exists
watch_file "${PWD}/install/setup.bash"
if [[ -f "${PWD}/install/setup.bash" ]]; then
    source "${PWD}/install/setup.bash"
fi
